<?xml version="1.0" encoding="UTF-8"?>
<beans 
  xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="
    http://www.springframework.org/schema/beans 
      http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
    http://www.springframework.org/schema/util 
      http://www.springframework.org/schema/util/spring-util-2.5.xsd">

  <bean id="globalSetting" class="marubinotto.piggydb.external.jdbc.h2.H2GlobalSetting">
    <property name="jdbcTemplate"><ref bean="jdbcTemplate"/></property>
  </bean>

  <bean id="ownerAuth" class="marubinotto.piggydb.model.OwnerAuth">
    <property name="globalSetting"><ref bean="globalSetting"/></property>
  </bean>

  <bean id="defaultAuth" class="marubinotto.piggydb.model.DefaultAuth">
    <property name="fragmentRepository"><ref bean="fragmentRepository"/></property>
  </bean>

  <bean id="authentication" class="marubinotto.piggydb.model.Authentication">
    <property name="ownerAuth"><ref bean="ownerAuth"/></property>
    <property name="defaultAuth"><ref bean="defaultAuth"/></property>
    <property name="enableGuest" value="false"/>
    <property name="enableAnonymous" value="${piggydb.enableAnonymous}"/>
  </bean>
  
  <bean id="tagRepository" class="marubinotto.piggydb.external.jdbc.h2.H2TagRepository">
    <property name="jdbcTemplate"><ref bean="jdbcTemplate"/></property>
    <property name="tagIdIncrementer"><ref bean="seqTagId"/></property>
  </bean>

  <bean id="fragmentRepository" class="marubinotto.piggydb.external.jdbc.h2.H2FragmentRepository">
    <property name="jdbcTemplate"><ref bean="jdbcTemplate"/></property>
    <property name="fragmentIdIncrementer"><ref bean="seqFragmentId"/></property>
    <property name="relationIdIncrementer"><ref bean="seqRelationId"/></property>
    <property name="tagRepository"><ref bean="tagRepository"/></property>
    <property name="fileRepository"><ref bean="fileRepository"/></property>
  </bean>

  <bean id="filterRepository" class="marubinotto.piggydb.external.jdbc.h2.H2FilterRepository">
    <property name="jdbcTemplate"><ref bean="jdbcTemplate"/></property>
    <property name="filterIdIncrementer"><ref bean="seqFilterId"/></property>
    <property name="tagRepository"><ref bean="tagRepository"/></property>
  </bean>
  
  <bean id="fileRepository" class="marubinotto.piggydb.external.file.FileRepositoryImpl">
    <property name="databasePath" ref="databasePath"/>
  </bean>

  <bean id="pigDump" class="marubinotto.piggydb.external.PigDump">
    <property name="dataSource"><ref bean="dataSource"/></property>
    <property name="fileRepository"><ref bean="fileRepository"/></property>
  </bean>

</beans>
